import numpy as np
import biorbd


class Muscles:
    R = 0.0085  # 0.002 * 0.5 + 0.01 * 0.25 + 0.02 * 0.25
    F = 0.0425  # 0.01 * 0.5 + 0.05 * 0.25 + 0.1 * 0.25
    r = 1


class Bow:
    """
    Contains references from useful markers.
    """

    segment_idx = 8
    hair_idx = 9
    contact_marker = 19
    frog_marker = 16
    tip_marker = 18

    def __init__(self, bow_side):
        """
        Contains the side of the bow.
        """
        if bow_side not in ["frog", "tip"]:
            raise RuntimeError(bow_side + " is not a valid side of bow, it must be frog or tip.")
        self.bow_side = bow_side

    @property
    def side(self):
        return self.bow_side


class Violin:
    """
    Contains initial values and references from useful markers and segments.
    """

    segment_idx = 17

    def __init__(self, string):
        """
        Contains some references and values specific to the string.
        :param string: violin string letter
        :param bow_side: side of the bow, "frog" or "tip".
        """
        if string not in ["E", "A", "D", "G"]:
            raise RuntimeError(string + " is not a valid string, it must be E, A, D or G. Do you know violin ?")
        self.string = string

    def initial_position(self):
        """
        :return: List of initial positions according to the string and the side of the bow.
        """
        return {
            "E": {
                "frog": [-0.2908, -0.4622, 0.6952, 1.1347, 1.4096, -0.1030, 0.1516, -0.2379, -0.2633, -0.07],
                "tip": [0.0876, -0.5649, 0.6498, 1.0598, -0.1866, 0.2434, 0.1582, 0.2087, 0.7162, -0.55],
            },
            "A": {
                "frog": [-0.1569, -0.5216, 0.5900, 1.1063, 1.4728, 0.0393, 0.3143, -0.3959, -0.4446, -0.07],
                "tip": [0.0305, -0.6904, 0.3695, 0.8809, 0.1557, 0.2997, 0.2071, 0.1471, 0.5546, -0.55],
            },
            "D": {
                "frog": [-0.1259, -0.4520, 0.5822, 1.1106, 1.4595, 0.1194, 0.5033, -0.4040, -0.4567, -0.07],
                "tip": [0.0378, -0.7034, 0.2345, 0.947, 0.1111, 0.4134, 0.2470, 0.2606, 0.4842, -0.55],
            },
            "G": {
                "frog": [-0.2697, -0.3733, 0.5529, 1.1676, 1.5453, 0.0877, 0.6603, -0.5842, -0.6424, -0.07],
                "tip": [-0.0182, -1.3112, 0.1928, 0.6092, 0.7065, -0.0755, 0.1720, 0.1136, 0.2626, -0.55],
            },
        }[self.string]

    @property
    def bridge_marker(self):
        """
        :return: Marker number on the bridge, associate to the string.
        """
        return {"E": 35, "A": 37, "D": 39, "G": 41,}[self.string]

    @property
    def neck_marker(self):
        """
        :return: Marker number on the neck of the violin, associate to the string.
        """
        return {"E": 36, "A": 38, "D": 40, "G": 42,}[self.string]

    @property
    def rt_on_string(self):
        """
        :return: RT number according to the string.
        """
        return {"E": 3, "A": 2, "D": 1, "G": 0,}[self.string]

    @property
    def external_force(self):
        # This was obtained from "utils.find_forces_and_moments"
        return {
            "E": np.array([0.0, 0.0, 0.0, 0.40989355, 1.84413989, 0.65660896]),
            "A": np.array([0.0, 0.0, 0.0, 0.30881124, 1.65124622, 1.08536701]),
            "D": np.array([0.0, 0.0, 0.0, 0.16081784, 1.30189937, 1.50970052]),
            "G": np.array([0.0, 0.0, 0.0, 0.05865013, 1.05013794, 1.7011086]),
        }[self.string]

    @property
    def x_init(self):
        return {
            "G": np.array(
                [
                    [
                        -1.08188357e-01,
                        -3.36433498e-01,
                        -3.92682686e-01,
                        -3.92646965e-01,
                        -3.92642532e-01,
                        -3.89450056e-01,
                        -3.92684710e-01,
                        -3.90655935e-01,
                        -3.70015010e-01,
                        -3.30368610e-01,
                        -2.81047993e-01,
                        -2.30893021e-01,
                        -1.82635025e-01,
                        -1.36161611e-01,
                        -9.21963223e-02,
                        -5.48669519e-02,
                        -3.53734923e-02,
                        -2.71342149e-02,
                        -1.67100949e-02,
                        -7.77593124e-03,
                        -1.23414580e-02,
                        -3.02229288e-02,
                        -4.89632006e-02,
                        -5.86157341e-02,
                        -7.57328328e-02,
                        -1.06418752e-01,
                        -1.54346899e-01,
                        -2.06555032e-01,
                        -2.41736764e-01,
                        -2.39683496e-01,
                        -1.93961819e-01,
                    ],
                    [
                        -1.33134848e00,
                        -1.14883543e00,
                        -1.14644446e00,
                        -1.19746386e00,
                        -1.23547862e00,
                        -1.26266628e00,
                        -1.27195284e00,
                        -1.28228887e00,
                        -1.31195431e00,
                        -1.36426168e00,
                        -1.42484457e00,
                        -1.48002347e00,
                        -1.52128918e00,
                        -1.53923386e00,
                        -1.51511242e00,
                        -1.42813556e00,
                        -1.27895230e00,
                        -1.12954965e00,
                        -1.02743776e00,
                        -9.54664985e-01,
                        -8.83251195e-01,
                        -8.15189756e-01,
                        -7.77061000e-01,
                        -7.86766128e-01,
                        -8.11297936e-01,
                        -8.35099998e-01,
                        -8.50326664e-01,
                        -8.65623907e-01,
                        -8.94619465e-01,
                        -9.51420218e-01,
                        -1.05011869e00,
                    ],
                    [
                        -3.63423343e-02,
                        3.18463897e-03,
                        1.36450896e-02,
                        2.38937220e-02,
                        4.46312607e-02,
                        6.89159793e-02,
                        9.37008603e-02,
                        1.14775078e-01,
                        1.30420826e-01,
                        1.42750231e-01,
                        1.53394785e-01,
                        1.63110276e-01,
                        1.71895734e-01,
                        1.78974384e-01,
                        1.81785907e-01,
                        1.76526711e-01,
                        1.62335073e-01,
                        1.46576704e-01,
                        1.35916540e-01,
                        1.29192158e-01,
                        1.25061683e-01,
                        1.25525184e-01,
                        1.34370028e-01,
                        1.51625124e-01,
                        1.72587272e-01,
                        1.91822080e-01,
                        2.05710032e-01,
                        2.09064460e-01,
                        1.96932718e-01,
                        1.66344205e-01,
                        1.20668581e-01,
                    ],
                    [
                        1.25172530e00,
                        1.23753050e00,
                        1.18500972e00,
                        1.12837871e00,
                        1.08680536e00,
                        1.06399562e00,
                        1.06582084e00,
                        1.08946800e00,
                        1.12495243e00,
                        1.16426992e00,
                        1.20198885e00,
                        1.23709210e00,
                        1.26759423e00,
                        1.28950048e00,
                        1.29559209e00,
                        1.27815438e00,
                        1.23911114e00,
                        1.18633993e00,
                        1.12754861e00,
                        1.06883136e00,
                        1.01631664e00,
                        9.75012577e-01,
                        9.50216153e-01,
                        9.45227794e-01,
                        9.65709112e-01,
                        1.01147425e00,
                        1.07671773e00,
                        1.14768983e00,
                        1.21166415e00,
                        1.26070385e00,
                        1.29147101e00,
                    ],
                    [
                        1.42071369e00,
                        1.44781473e00,
                        1.40311134e00,
                        1.31686638e00,
                        1.21155326e00,
                        1.09176132e00,
                        9.50146614e-01,
                        7.87436408e-01,
                        6.22543041e-01,
                        4.65969340e-01,
                        3.28057188e-01,
                        2.06878907e-01,
                        1.00757144e-01,
                        1.23549536e-02,
                        -4.69618186e-02,
                        -6.00034591e-02,
                        -2.05025818e-02,
                        7.30733673e-02,
                        2.04587082e-01,
                        3.50565218e-01,
                        4.94307808e-01,
                        6.29121098e-01,
                        7.57619226e-01,
                        8.92906145e-01,
                        1.02286746e00,
                        1.13347306e00,
                        1.21754545e00,
                        1.28848365e00,
                        1.35619142e00,
                        1.40986266e00,
                        1.39667879e00,
                    ],
                    [
                        -3.35306301e-01,
                        -2.46204666e-01,
                        -2.39092532e-01,
                        -2.56861116e-01,
                        -2.70186315e-01,
                        -2.79955366e-01,
                        -2.83849310e-01,
                        -2.89568799e-01,
                        -3.02254184e-01,
                        -3.22111704e-01,
                        -3.41497277e-01,
                        -3.53803994e-01,
                        -3.53015867e-01,
                        -3.30275693e-01,
                        -2.69202345e-01,
                        -1.55307202e-01,
                        -6.44574701e-04,
                        1.37500938e-01,
                        2.22671162e-01,
                        2.70242567e-01,
                        3.00014801e-01,
                        3.12419611e-01,
                        2.92074336e-01,
                        2.27994340e-01,
                        1.49338430e-01,
                        7.75124053e-02,
                        2.32421385e-02,
                        -2.06019155e-02,
                        -6.41668352e-02,
                        -1.13956301e-01,
                        -1.67172698e-01,
                    ],
                    [
                        -9.71303189e-02,
                        -1.11574009e-01,
                        -1.33158463e-01,
                        -1.48208798e-01,
                        -1.50342171e-01,
                        -1.41914432e-01,
                        -1.25435507e-01,
                        -1.04846944e-01,
                        -8.26029307e-02,
                        -5.93150749e-02,
                        -3.44212516e-02,
                        -7.80575123e-03,
                        2.05894543e-02,
                        5.07178512e-02,
                        8.25484259e-02,
                        1.17113418e-01,
                        1.57627551e-01,
                        2.05377398e-01,
                        2.58119977e-01,
                        3.13621478e-01,
                        3.68997812e-01,
                        4.18221014e-01,
                        4.50686806e-01,
                        4.57955635e-01,
                        4.40279539e-01,
                        4.01864969e-01,
                        3.49068931e-01,
                        2.89436241e-01,
                        2.28096027e-01,
                        1.66548434e-01,
                        1.04531208e-01,
                    ],
                    [
                        1.79271643e-01,
                        -1.09005548e-01,
                        -4.81286355e-02,
                        1.25687304e-01,
                        2.31848103e-01,
                        2.61783898e-01,
                        2.61123611e-01,
                        2.61773030e-01,
                        2.57445064e-01,
                        2.61628983e-01,
                        2.61566097e-01,
                        2.59766760e-01,
                        2.61714887e-01,
                        2.61646149e-01,
                        2.31670667e-01,
                        1.48379670e-01,
                        4.71661503e-02,
                        -5.49832179e-02,
                        -1.41789765e-01,
                        -1.76872490e-01,
                        -1.29189584e-01,
                        -8.85123325e-04,
                        1.48547569e-01,
                        2.39609866e-01,
                        2.61619064e-01,
                        2.61784777e-01,
                        2.61664062e-01,
                        2.15012243e-01,
                        9.23091083e-02,
                        -4.42349047e-02,
                        1.26778979e-01,
                    ],
                    [
                        -7.85391127e-01,
                        -4.44781026e-01,
                        -3.82590952e-01,
                        -4.02756392e-01,
                        -3.53145416e-01,
                        -2.35145191e-01,
                        -9.05507857e-02,
                        4.90296066e-02,
                        1.78477998e-01,
                        2.82728854e-01,
                        3.71174980e-01,
                        4.45533033e-01,
                        5.03384596e-01,
                        5.49808266e-01,
                        6.05186761e-01,
                        6.82453819e-01,
                        7.46955720e-01,
                        7.84143409e-01,
                        7.85370460e-01,
                        7.26817743e-01,
                        5.87718765e-01,
                        3.69469234e-01,
                        1.15570352e-01,
                        -1.16621358e-01,
                        -2.98581755e-01,
                        -4.54363259e-01,
                        -5.88242339e-01,
                        -6.59452194e-01,
                        -6.45774691e-01,
                        -5.99251398e-01,
                        -7.85392513e-01,
                    ],
                    [
                        -7.00000000e-02,
                        -9.76587466e-02,
                        -1.30874168e-01,
                        -1.70331998e-01,
                        -2.17142854e-01,
                        -2.68172934e-01,
                        -3.20602888e-01,
                        -3.71492322e-01,
                        -4.16630636e-01,
                        -4.54076774e-01,
                        -4.83524405e-01,
                        -5.06385307e-01,
                        -5.23802429e-01,
                        -5.36703391e-01,
                        -5.45647039e-01,
                        -5.50000000e-01,
                        -5.47512227e-01,
                        -5.37272600e-01,
                        -5.19854393e-01,
                        -4.95841430e-01,
                        -4.65244915e-01,
                        -4.27439891e-01,
                        -3.82801738e-01,
                        -3.32102577e-01,
                        -2.80006796e-01,
                        -2.29037101e-01,
                        -1.82353052e-01,
                        -1.42285344e-01,
                        -1.10333062e-01,
                        -8.74236135e-02,
                        -7.00000000e-02,
                    ],
                    [
                        -2.66215984e01,
                        -5.62005403e00,
                        -2.02125839e00,
                        1.12137708e00,
                        -6.76374739e-01,
                        6.66395124e-01,
                        -6.35302788e-01,
                        6.38835166e-01,
                        1.59041676e00,
                        2.83303465e00,
                        2.99340873e00,
                        2.96310670e00,
                        2.83033143e00,
                        2.72921957e00,
                        2.58773366e00,
                        2.01798003e00,
                        6.44407333e-01,
                        2.99995981e-01,
                        6.54722828e-01,
                        3.06582102e-01,
                        -6.58650869e-01,
                        -1.22030504e00,
                        -8.71590428e-01,
                        -4.60048659e-01,
                        -1.39235839e00,
                        -2.01311288e00,
                        -3.29367375e00,
                        -2.92543251e00,
                        -1.52230210e00,
                        1.22553474e00,
                        3.62298999e00,
                    ],
                    [
                        2.58278677e01,
                        2.06284753e00,
                        -7.18006024e-01,
                        -4.27946693e00,
                        -7.95789283e-01,
                        -1.95376601e00,
                        2.70129347e-01,
                        -1.18155191e00,
                        -2.01859521e00,
                        -3.71433814e00,
                        -3.39479629e00,
                        -3.12342088e00,
                        -1.87864829e00,
                        -3.68556035e-01,
                        2.82758858e00,
                        6.77975262e00,
                        1.00373284e01,
                        8.11888260e00,
                        4.99364930e00,
                        4.07698774e00,
                        4.26946882e00,
                        3.52976659e00,
                        8.35816777e-01,
                        -1.61246999e00,
                        -1.52939144e00,
                        -1.63920513e00,
                        -7.51648168e-01,
                        -1.14393312e00,
                        -2.07797712e00,
                        -4.14193376e00,
                        -7.19982181e00,
                    ],
                    [
                        4.58712386e00,
                        8.09865009e-01,
                        6.52340805e-01,
                        8.07017441e-01,
                        1.50722294e00,
                        1.44917409e00,
                        1.44312754e00,
                        1.10287822e00,
                        7.93613687e-01,
                        6.90652078e-01,
                        5.87232049e-01,
                        5.78132758e-01,
                        4.87274142e-01,
                        3.78897010e-01,
                        -4.16533914e-04,
                        -5.65856648e-01,
                        -1.05647631e00,
                        -8.58992337e-01,
                        -5.00785292e-01,
                        -3.35108284e-01,
                        -1.63606954e-01,
                        2.18924257e-01,
                        8.17069652e-01,
                        1.17834332e00,
                        1.25171964e00,
                        9.69489781e-01,
                        5.94404401e-01,
                        -1.98170279e-01,
                        -1.17926160e00,
                        -2.30885508e00,
                        -2.92033096e00,
                    ],
                    [
                        2.59017166e00,
                        -2.74741185e00,
                        -3.31525087e00,
                        -3.27162075e00,
                        -1.82483772e00,
                        -8.43316414e-01,
                        9.12444764e-01,
                        1.88885627e00,
                        2.37788994e00,
                        2.33425774e00,
                        2.18746342e00,
                        2.02382310e00,
                        1.62876438e00,
                        1.01197154e00,
                        -2.32776602e-01,
                        -1.76602123e00,
                        -2.87342543e00,
                        -3.44528617e00,
                        -3.58523802e00,
                        -3.44318462e00,
                        -2.89622233e00,
                        -2.04969795e00,
                        -9.09084115e-01,
                        4.29393136e-01,
                        1.99232113e00,
                        3.39772735e00,
                        4.30915616e00,
                        4.18153059e00,
                        3.53062698e00,
                        2.40621560e00,
                        1.42658820e00,
                    ],
                    [
                        3.11657861e00,
                        -8.14111346e-01,
                        -4.59810546e00,
                        -5.73560046e00,
                        -6.70246079e00,
                        -7.56368258e00,
                        -9.14049831e00,
                        -9.98964566e00,
                        -9.74546591e00,
                        -8.82864979e00,
                        -7.70896591e00,
                        -6.81960367e00,
                        -5.89345166e00,
                        -4.71155329e00,
                        -2.40773207e00,
                        8.49415264e-01,
                        3.92506374e00,
                        7.08282613e00,
                        8.48113329e00,
                        8.93645554e00,
                        8.34800134e00,
                        7.67473064e00,
                        7.74883461e00,
                        7.89438323e00,
                        7.62969262e00,
                        5.68792241e00,
                        4.50622183e00,
                        3.95196655e00,
                        4.01559012e00,
                        2.25533207e00,
                        -3.89347542e00,
                    ],
                    [
                        1.14421167e01,
                        1.49330818e00,
                        -2.51643597e-01,
                        -1.48183043e00,
                        -2.64427447e-01,
                        -7.01279415e-01,
                        5.41466214e-02,
                        -5.72772015e-01,
                        -7.78334701e-01,
                        -1.35261339e00,
                        -8.84964155e-01,
                        -5.44219702e-01,
                        6.02438254e-01,
                        2.02840550e00,
                        4.92134343e00,
                        8.03934301e00,
                        9.71608810e00,
                        7.02652831e00,
                        3.79235448e00,
                        2.16099125e00,
                        1.35288021e00,
                        5.42457558e-02,
                        -2.54827685e00,
                        -4.61478833e00,
                        -4.78732175e00,
                        -3.93406966e00,
                        -2.83818297e00,
                        -2.44971336e00,
                        -2.64634523e00,
                        -3.10776556e00,
                        -3.13615547e00,
                    ],
                    [
                        1.18492620e00,
                        -1.75819407e00,
                        -5.60825799e-01,
                        -9.44916740e-01,
                        5.12081076e-01,
                        5.85646399e-01,
                        1.21893211e00,
                        1.24638616e00,
                        1.46708045e00,
                        1.37806422e00,
                        1.59726931e00,
                        1.58193709e00,
                        1.75896416e00,
                        1.77694406e00,
                        1.92228331e00,
                        2.17557845e00,
                        2.74283571e00,
                        3.11548323e00,
                        3.26614217e00,
                        3.40901253e00,
                        3.23494151e00,
                        2.57910476e00,
                        1.22669463e00,
                        -4.31331134e-01,
                        -1.67977832e00,
                        -2.89079999e00,
                        -3.49570917e00,
                        -3.68870621e00,
                        -3.66015553e00,
                        -3.58492878e00,
                        -3.70894486e00,
                    ],
                    [
                        -3.10961380e01,
                        -4.15087335e00,
                        1.13148607e01,
                        9.18851625e00,
                        2.93354503e00,
                        1.30325453e-01,
                        -9.29934549e-01,
                        -2.58207847e-01,
                        -4.79139015e-01,
                        3.36325130e-01,
                        -3.19335911e-01,
                        1.23211094e-01,
                        1.87615317e-01,
                        -5.93587380e-02,
                        -3.27479518e00,
                        -6.47163876e00,
                        -5.47264673e00,
                        -6.27260572e00,
                        -3.66809456e00,
                        -3.47105849e-01,
                        5.89634993e00,
                        9.70670121e00,
                        8.15565513e00,
                        4.54849758e00,
                        -1.51533788e00,
                        1.66809461e00,
                        -1.75186168e00,
                        -3.59833933e00,
                        -1.06265077e01,
                        -5.18672058e00,
                        2.58384077e01,
                    ],
                    [
                        3.13571083e01,
                        9.93380395e00,
                        -2.33273200e00,
                        2.42818521e-01,
                        6.12421210e00,
                        8.45437046e00,
                        9.40971296e00,
                        8.28819726e00,
                        7.43540853e00,
                        5.54489484e00,
                        5.04557786e00,
                        3.85467416e00,
                        3.02316364e00,
                        2.44617909e00,
                        4.01134273e00,
                        5.08432586e00,
                        2.50367171e00,
                        1.60929893e00,
                        -1.77321330e00,
                        -5.37098923e00,
                        -1.12140375e01,
                        -1.51424714e01,
                        -1.53447082e01,
                        -1.36578622e01,
                        -8.46327555e00,
                        -1.03674074e01,
                        -5.75097793e00,
                        -2.98991776e00,
                        4.30907360e00,
                        9.61065977e-01,
                        -2.33268601e01,
                    ],
                    [
                        -1.29449653e00,
                        -1.88611338e00,
                        -2.09951650e00,
                        -2.62416571e00,
                        -2.97466157e00,
                        -3.12968613e00,
                        -3.13835545e00,
                        -2.92381476e00,
                        -2.48296167e00,
                        -1.98759709e00,
                        -1.54717699e00,
                        -1.19781777e00,
                        -8.97209601e-01,
                        -6.58052729e-01,
                        -4.26727989e-01,
                        -1.02381165e-01,
                        3.95212286e-01,
                        8.39240349e-01,
                        1.25302722e00,
                        1.62809931e00,
                        2.04994153e00,
                        2.46535783e00,
                        2.88346789e00,
                        3.14573895e00,
                        3.09479314e00,
                        3.00908121e00,
                        2.59813482e00,
                        2.20653759e00,
                        1.61767580e00,
                        1.13906203e00,
                        8.68705057e-01,
                    ],
                ]
            )
        }[self.string]

    @property
    def u_init(self):
        return {
            "G": np.array(
                [
                    [
                        1.44105214e-05,
                        -1.30218623e-05,
                        -6.86427323e-06,
                        -3.47988606e-05,
                        -2.89791114e-05,
                        -5.80523098e-05,
                        -3.81503016e-05,
                        -1.79819314e-05,
                        5.98019345e-06,
                        2.79215380e-05,
                        4.10891513e-05,
                        5.14959065e-05,
                        6.08250522e-05,
                        8.15701108e-05,
                        8.21716565e-05,
                        4.18394350e-05,
                        3.72777399e-05,
                        7.00211456e-05,
                        6.98401909e-05,
                        3.58593937e-05,
                        4.99882228e-06,
                        -1.00313526e-05,
                        -7.74638799e-06,
                        -3.30995874e-05,
                        -4.94777881e-05,
                        -9.12457129e-05,
                        -7.54598014e-05,
                        -4.68604361e-05,
                        7.67464839e-06,
                        5.90260853e-05,
                    ],
                    [
                        2.99662535e-04,
                        1.50188475e-04,
                        -1.88769632e-04,
                        -1.57448762e-04,
                        -3.02504095e-04,
                        -3.15178181e-04,
                        -3.47128384e-04,
                        -2.83792542e-04,
                        -2.39544081e-04,
                        -1.35092765e-04,
                        -4.66748969e-05,
                        1.36138887e-05,
                        4.50608697e-05,
                        1.14729064e-04,
                        1.97726703e-04,
                        3.09035097e-04,
                        2.85965427e-04,
                        2.00885767e-04,
                        4.05949501e-05,
                        -6.62777936e-05,
                        -1.11943126e-04,
                        -1.98079271e-04,
                        -2.15739298e-04,
                        -1.97429819e-04,
                        -2.03855860e-04,
                        7.37263890e-05,
                        1.03731449e-04,
                        6.87401275e-05,
                        -2.78998836e-06,
                        -2.14017336e-05,
                    ],
                    [
                        -6.67391513e-05,
                        1.11569756e-05,
                        7.18390979e-05,
                        3.96776599e-05,
                        2.68312114e-05,
                        -8.09888135e-06,
                        -5.15534480e-05,
                        -9.38169625e-05,
                        -1.04178609e-04,
                        -1.34898529e-04,
                        -1.48226003e-04,
                        -1.43589440e-04,
                        -1.37686286e-04,
                        -1.48734315e-04,
                        -1.74598240e-04,
                        -1.79219321e-04,
                        -1.61257698e-04,
                        -1.17933051e-04,
                        -7.37934868e-06,
                        1.04212103e-04,
                        1.52255989e-04,
                        2.06255134e-04,
                        1.87505164e-04,
                        1.64011377e-04,
                        1.40267023e-04,
                        -7.03717742e-06,
                        -1.94124641e-05,
                        -1.23634176e-05,
                        -2.92400394e-06,
                        -8.81947149e-06,
                    ],
                    [
                        -8.30025008e-05,
                        -5.68263909e-05,
                        1.20023968e-04,
                        2.68312711e-04,
                        4.72081318e-04,
                        6.26359685e-04,
                        6.73832439e-04,
                        5.69897908e-04,
                        3.83182457e-04,
                        2.21978012e-04,
                        8.01453144e-05,
                        -1.20831595e-05,
                        -8.55896797e-05,
                        -1.43180621e-04,
                        -1.80757833e-04,
                        -1.17230622e-04,
                        1.44515020e-05,
                        1.43920330e-04,
                        2.65282186e-04,
                        3.69616708e-04,
                        4.63580149e-04,
                        5.36121520e-04,
                        5.08477940e-04,
                        4.83268652e-04,
                        4.93092369e-04,
                        4.17102809e-04,
                        2.28896842e-04,
                        1.04589839e-04,
                        -3.24730282e-05,
                        -1.07092604e-04,
                    ],
                    [
                        1.20887154e00,
                        2.73814971e00,
                        2.95726721e00,
                        2.89151815e00,
                        2.48842867e00,
                        2.06830459e00,
                        1.78023871e00,
                        1.48166205e00,
                        1.32657339e00,
                        1.05365529e00,
                        8.16622395e-01,
                        6.42276742e-01,
                        5.72013845e-01,
                        7.65475573e-01,
                        1.17345013e00,
                        1.45676180e00,
                        1.62910552e00,
                        1.72608021e00,
                        1.75796889e00,
                        1.71540036e00,
                        1.79543831e00,
                        1.97906545e00,
                        2.36818036e00,
                        2.69460178e00,
                        2.69059813e00,
                        2.85192547e00,
                        3.31968283e00,
                        3.23815007e00,
                        3.00756645e00,
                        1.65374671e00,
                    ],
                    [
                        -2.51144901e-02,
                        1.77260768e-01,
                        3.28571499e-02,
                        5.64554099e-02,
                        2.67921212e-01,
                        2.69783775e-01,
                        4.24000438e-01,
                        4.42054013e-01,
                        3.60528800e-01,
                        2.55436683e-01,
                        7.88108750e-02,
                        5.35649436e-02,
                        -6.19465165e-02,
                        8.03397938e-03,
                        8.64578609e-03,
                        1.30057958e-01,
                        7.53977951e-02,
                        1.18212920e-01,
                        3.24426317e-02,
                        5.54523267e-02,
                        3.62390585e-02,
                        1.99237611e-01,
                        2.75330363e-01,
                        3.50114639e-01,
                        1.92563602e-01,
                        1.68039065e-01,
                        2.13805861e-01,
                        1.36488536e-01,
                        8.35414090e-02,
                        -1.61440608e-01,
                    ],
                    [
                        -2.57294776e-01,
                        -2.15748572e-01,
                        -2.24602685e-01,
                        -1.71370426e-01,
                        -1.62973001e-01,
                        -1.23024530e-01,
                        -1.12109865e-01,
                        -7.60716104e-02,
                        -7.05984182e-02,
                        -4.81131766e-02,
                        -3.98691449e-02,
                        -3.23970845e-02,
                        -2.07361666e-02,
                        -2.41910396e-02,
                        -1.65084001e-02,
                        -2.86286419e-02,
                        -2.88582951e-02,
                        -4.28254899e-02,
                        -5.22361326e-02,
                        -6.38886124e-02,
                        -8.60957951e-02,
                        -9.15100416e-02,
                        -1.20337386e-01,
                        -1.32580250e-01,
                        -1.70089896e-01,
                        -1.88432329e-01,
                        -2.10282410e-01,
                        -2.33502984e-01,
                        -2.43195466e-01,
                        -2.61456257e-01,
                    ],
                    [
                        7.89456630e-01,
                        5.30631120e-01,
                        -5.43432554e-01,
                        -5.25047305e-01,
                        -1.64866049e-01,
                        6.70530607e-02,
                        4.02552743e-01,
                        6.35598353e-01,
                        7.25904281e-01,
                        5.83345818e-01,
                        5.08711641e-01,
                        4.27571585e-01,
                        3.48369361e-01,
                        2.18401901e-01,
                        3.14140683e-01,
                        6.14930944e-01,
                        4.47025051e-01,
                        5.82334518e-01,
                        5.42002002e-01,
                        7.49191211e-01,
                        6.95452903e-01,
                        5.50087365e-01,
                        3.24867610e-01,
                        -2.10618867e-01,
                        1.54445017e-01,
                        -5.48568143e-01,
                        -3.17028686e-01,
                        -8.12577779e-01,
                        -1.02807307e-01,
                        1.16795934e00,
                    ],
                    [
                        2.35327723e-02,
                        3.73822102e-02,
                        1.49115677e-02,
                        3.78430311e-02,
                        1.53999566e-02,
                        3.72594378e-02,
                        1.65851830e-02,
                        3.61479387e-02,
                        1.81789470e-02,
                        3.47190308e-02,
                        2.01847094e-02,
                        3.26816630e-02,
                        2.23959411e-02,
                        3.03964655e-02,
                        2.44639490e-02,
                        2.79713655e-02,
                        2.52624444e-02,
                        2.62216108e-02,
                        2.92462515e-02,
                        2.41985366e-02,
                        3.08049523e-02,
                        2.23144226e-02,
                        3.17541825e-02,
                        2.14917060e-02,
                        3.23662058e-02,
                        2.02765227e-02,
                        3.30961558e-02,
                        1.97291064e-02,
                        3.31113570e-02,
                        1.95950227e-02,
                    ],
                    [
                        -5.31212808e-03,
                        -4.66972785e-03,
                        -5.31074200e-03,
                        -4.66978205e-03,
                        -5.31021860e-03,
                        -4.66989632e-03,
                        -5.31023545e-03,
                        -4.66996199e-03,
                        -5.31017116e-03,
                        -4.66977782e-03,
                        -5.31034812e-03,
                        -4.66957696e-03,
                        -5.31054567e-03,
                        -4.66935282e-03,
                        -5.31075112e-03,
                        -4.66905912e-03,
                        -5.31064690e-03,
                        -4.66894904e-03,
                        -5.31130563e-03,
                        -4.66873614e-03,
                        -5.31139461e-03,
                        -4.66853488e-03,
                        -5.31167001e-03,
                        -4.66834774e-03,
                        -5.31173823e-03,
                        -4.66825069e-03,
                        -5.31183743e-03,
                        -4.66816179e-03,
                        -5.31205921e-03,
                        -4.66808242e-03,
                    ],
                    [
                        7.11106361e-05,
                        1.11829251e-04,
                        4.94226861e-02,
                        4.63555925e-02,
                        1.03189179e-01,
                        1.09352173e-01,
                        1.25884459e-01,
                        1.02119439e-01,
                        7.00115797e-02,
                        4.21164774e-02,
                        1.63326557e-02,
                        5.22396004e-03,
                        6.11935005e-04,
                        4.81142310e-04,
                        1.56360921e-04,
                        9.69902145e-05,
                        3.96572927e-04,
                        3.88742228e-02,
                        8.01215423e-02,
                        1.07668744e-01,
                        1.23986763e-01,
                        1.37369863e-01,
                        1.25122442e-01,
                        1.03788904e-01,
                        8.81704532e-02,
                        2.34564853e-02,
                        1.61716307e-04,
                        1.10253762e-04,
                        2.55427092e-03,
                        2.97050661e-02,
                    ],
                    [
                        1.22532163e-04,
                        1.70287554e-04,
                        3.34685199e-02,
                        2.38184372e-02,
                        6.07298335e-02,
                        5.75293258e-02,
                        7.04394247e-02,
                        5.68388584e-02,
                        3.89185021e-02,
                        2.32527226e-02,
                        8.42131594e-03,
                        4.16285868e-03,
                        2.04138236e-03,
                        4.81408723e-03,
                        1.00101355e-03,
                        1.87470848e-04,
                        5.30723393e-04,
                        2.24905893e-02,
                        4.16628493e-02,
                        4.54127018e-02,
                        4.25814566e-02,
                        4.30035082e-02,
                        3.93924461e-02,
                        2.48158430e-02,
                        1.24253385e-02,
                        8.17944139e-05,
                        6.50114217e-05,
                        8.55027891e-05,
                        3.96731852e-03,
                        3.39216034e-02,
                    ],
                    [
                        9.63764291e-04,
                        2.12794454e-03,
                        3.16523445e-03,
                        4.02155223e-03,
                        2.49771520e-03,
                        2.47295286e-03,
                        2.30707663e-03,
                        3.37152960e-03,
                        3.09626052e-03,
                        2.12104601e-03,
                        9.05838691e-04,
                        5.20531497e-04,
                        3.23905913e-04,
                        2.44029406e-04,
                        2.08808642e-04,
                        3.79738678e-04,
                        1.57457106e-03,
                        3.78023795e-03,
                        5.01148649e-03,
                        4.52944640e-03,
                        1.48133717e-03,
                        3.67039134e-04,
                        2.54473069e-04,
                        3.10569307e-04,
                        3.85475274e-04,
                        3.88127178e-03,
                        6.48304863e-03,
                        5.32044076e-03,
                        9.75215566e-04,
                        4.14123743e-04,
                    ],
                    [
                        3.40895068e-05,
                        1.41416889e-05,
                        1.11391111e-05,
                        1.03186234e-05,
                        1.01027639e-05,
                        1.06594971e-05,
                        1.07306095e-05,
                        1.16649797e-05,
                        1.20883434e-05,
                        1.40440568e-05,
                        1.64749940e-05,
                        1.91279162e-05,
                        1.95259636e-05,
                        1.50442283e-05,
                        1.04708203e-05,
                        9.33502114e-06,
                        8.71258496e-06,
                        8.30974745e-06,
                        8.44017271e-06,
                        9.06234098e-06,
                        8.80829898e-06,
                        7.95246089e-06,
                        7.02456567e-06,
                        6.89552027e-06,
                        7.59695060e-06,
                        8.54362859e-06,
                        8.27701409e-06,
                        9.10888468e-06,
                        1.02549473e-05,
                        1.85801461e-05,
                    ],
                    [
                        5.07168525e-05,
                        2.21087396e-05,
                        1.85250775e-05,
                        1.65612165e-05,
                        1.67318063e-05,
                        1.72983549e-05,
                        1.72943259e-05,
                        1.78463128e-05,
                        1.76619215e-05,
                        2.02406552e-05,
                        2.45380648e-05,
                        3.00114666e-05,
                        3.30371108e-05,
                        2.44479591e-05,
                        1.57756999e-05,
                        1.23877469e-05,
                        1.07824267e-05,
                        1.01551991e-05,
                        1.03430088e-05,
                        1.13692959e-05,
                        1.19558758e-05,
                        1.20229833e-05,
                        1.13518764e-05,
                        1.14244024e-05,
                        1.32744653e-05,
                        1.42569416e-05,
                        1.36497307e-05,
                        1.53854411e-05,
                        1.83749126e-05,
                        3.53619876e-05,
                    ],
                    [
                        4.79590369e-05,
                        2.09871791e-05,
                        1.78426912e-05,
                        1.62189228e-05,
                        1.66327200e-05,
                        1.74352721e-05,
                        1.76223752e-05,
                        1.83196701e-05,
                        1.81654389e-05,
                        2.07563855e-05,
                        2.49906844e-05,
                        3.02602916e-05,
                        3.29286473e-05,
                        2.40931581e-05,
                        1.54568319e-05,
                        1.21611475e-05,
                        1.06950703e-05,
                        1.02267096e-05,
                        1.05587186e-05,
                        1.17000112e-05,
                        1.23356139e-05,
                        1.23833155e-05,
                        1.16269962e-05,
                        1.15982822e-05,
                        1.33185351e-05,
                        1.41380946e-05,
                        1.33856697e-05,
                        1.49227801e-05,
                        1.75980003e-05,
                        3.36790837e-05,
                    ],
                    [
                        8.92748601e-05,
                        1.33661607e-04,
                        3.58299754e-02,
                        7.14471218e-02,
                        1.27250298e-01,
                        1.62409369e-01,
                        1.72331869e-01,
                        1.43665905e-01,
                        9.77933818e-02,
                        6.16682380e-02,
                        3.31158051e-02,
                        1.51786347e-02,
                        3.09030215e-03,
                        3.95268293e-04,
                        1.94927642e-04,
                        3.30867352e-04,
                        1.02865622e-02,
                        3.80333292e-02,
                        6.91599712e-02,
                        1.01340231e-01,
                        1.29899410e-01,
                        1.51535933e-01,
                        1.40762077e-01,
                        1.28860100e-01,
                        1.26958764e-01,
                        1.03070523e-01,
                        5.54280665e-02,
                        2.46048413e-02,
                        3.65396271e-04,
                        1.16364521e-04,
                    ],
                    [
                        3.22550131e-04,
                        8.21675845e-05,
                        3.50788242e-02,
                        1.04108075e-01,
                        1.98697664e-01,
                        2.70296475e-01,
                        2.99440214e-01,
                        2.57781981e-01,
                        1.69503256e-01,
                        1.21795153e-01,
                        9.40711587e-02,
                        7.89700934e-02,
                        6.84545121e-02,
                        8.29462566e-02,
                        9.83485949e-02,
                        1.17391655e-01,
                        9.89269084e-02,
                        1.17692556e-01,
                        1.48310422e-01,
                        2.08454915e-01,
                        2.81133544e-01,
                        3.54649964e-01,
                        3.40595338e-01,
                        3.07279407e-01,
                        3.06250325e-01,
                        2.34237402e-01,
                        1.20688311e-01,
                        5.12342166e-02,
                        1.86384645e-04,
                        5.79599311e-05,
                    ],
                    [
                        1.88411007e-04,
                        1.81211064e-04,
                        3.35062883e-04,
                        1.38230192e-04,
                        1.47511471e-04,
                        1.10992450e-04,
                        2.17018525e-04,
                        3.41591653e-03,
                        2.18330264e-02,
                        3.13477302e-02,
                        3.45470499e-02,
                        3.20015265e-02,
                        3.16848480e-02,
                        2.51536175e-02,
                        1.92333665e-02,
                        8.15342606e-04,
                        5.46610141e-04,
                        2.68957553e-04,
                        9.90883154e-05,
                        4.90433529e-05,
                        3.70357245e-05,
                        2.98959947e-05,
                        3.29401203e-05,
                        3.77336654e-05,
                        4.20114902e-05,
                        7.35850278e-05,
                        1.39403963e-04,
                        2.91807374e-04,
                        4.03979873e-03,
                        1.22077994e-02,
                    ],
                    [
                        1.32625693e-05,
                        3.33240853e-05,
                        1.15877001e-01,
                        5.63066647e-02,
                        9.15914422e-02,
                        5.76987652e-02,
                        5.04424212e-02,
                        2.40602714e-02,
                        3.18870826e-02,
                        1.00802826e-03,
                        1.14462466e-04,
                        7.54592985e-05,
                        7.20012189e-05,
                        4.43345740e-05,
                        2.52335106e-05,
                        1.39540199e-05,
                        1.15682219e-05,
                        1.30005310e-05,
                        2.53418122e-05,
                        6.47967990e-05,
                        7.07582391e-05,
                        1.14898380e-03,
                        1.22744403e-02,
                        3.55448740e-03,
                        1.67091649e-03,
                        1.35754869e-05,
                        1.71633195e-05,
                        3.14872869e-05,
                        1.02968791e-02,
                        4.15472106e-02,
                    ],
                    [
                        4.04961279e-05,
                        8.14260760e-05,
                        2.94698624e-02,
                        6.55081212e-03,
                        2.29336520e-02,
                        1.11405518e-02,
                        1.72161992e-02,
                        1.38880848e-02,
                        2.43464203e-02,
                        1.65711575e-02,
                        1.06740652e-02,
                        5.89810194e-03,
                        6.84520414e-03,
                        5.61278792e-04,
                        1.23828091e-04,
                        4.15199889e-05,
                        3.59034408e-05,
                        4.06491453e-05,
                        6.40493702e-05,
                        8.18771214e-05,
                        8.44291472e-05,
                        1.38388484e-04,
                        2.93858202e-04,
                        2.90968011e-04,
                        3.31159152e-04,
                        4.49401131e-05,
                        5.58462823e-05,
                        9.86291230e-05,
                        5.38676280e-03,
                        1.92089384e-02,
                    ],
                    [
                        1.36207199e-01,
                        5.49201453e-02,
                        2.25434765e-05,
                        1.74115289e-05,
                        1.03482285e-05,
                        9.31083676e-06,
                        8.67244645e-06,
                        1.05944841e-05,
                        1.43165164e-05,
                        2.89027107e-05,
                        2.03261972e-04,
                        3.80729413e-02,
                        7.02813024e-02,
                        1.19591535e-01,
                        1.71163096e-01,
                        1.92407322e-01,
                        1.12174989e-01,
                        4.54336498e-03,
                        2.35752851e-05,
                        1.52744027e-05,
                        1.38247101e-05,
                        1.70745496e-05,
                        2.06505887e-05,
                        1.73742771e-05,
                        1.51921158e-05,
                        1.31898927e-05,
                        2.19826072e-05,
                        4.64818560e-05,
                        1.64557492e-02,
                        5.41584883e-02,
                    ],
                    [
                        1.71367641e-01,
                        3.24160743e-01,
                        3.13712729e-01,
                        3.35051829e-01,
                        2.72067627e-01,
                        2.28039206e-01,
                        1.71584233e-01,
                        1.25446451e-01,
                        1.02355911e-01,
                        7.65253071e-02,
                        5.83206854e-02,
                        4.66919711e-02,
                        4.39528376e-02,
                        7.52976677e-02,
                        1.30242820e-01,
                        1.78708362e-01,
                        1.91646685e-01,
                        1.87316101e-01,
                        1.82300152e-01,
                        1.89589811e-01,
                        2.42974054e-01,
                        3.36149578e-01,
                        3.98023452e-01,
                        4.09793991e-01,
                        3.41281385e-01,
                        2.70046525e-01,
                        3.21974480e-01,
                        3.30446756e-01,
                        3.29427117e-01,
                        2.05230869e-01,
                    ],
                    [
                        8.17843068e-02,
                        2.05433180e-01,
                        2.74936071e-01,
                        3.29554687e-01,
                        3.58423623e-01,
                        3.71546930e-01,
                        3.60538675e-01,
                        3.02621379e-01,
                        2.30889610e-01,
                        1.64206421e-01,
                        1.09784003e-01,
                        7.24822312e-02,
                        4.96501922e-02,
                        5.14122684e-02,
                        7.07392613e-02,
                        1.02487262e-01,
                        1.40154459e-01,
                        1.80249870e-01,
                        2.10117180e-01,
                        2.35505087e-01,
                        2.73807745e-01,
                        3.07460306e-01,
                        3.32486266e-01,
                        3.48818005e-01,
                        3.41480062e-01,
                        3.47689826e-01,
                        3.27418239e-01,
                        2.76507565e-01,
                        2.15113841e-01,
                        9.96443306e-02,
                    ],
                    [
                        7.26377883e-04,
                        3.35299910e-03,
                        2.44781896e-03,
                        7.17028106e-03,
                        6.09227888e-03,
                        1.15637893e-02,
                        7.76557037e-03,
                        4.22032785e-03,
                        1.12924588e-03,
                        4.24083952e-04,
                        2.83520261e-04,
                        2.22437206e-04,
                        1.82366392e-04,
                        1.33795132e-04,
                        1.30057230e-04,
                        2.49528041e-04,
                        2.78193011e-04,
                        1.50571446e-04,
                        1.50346852e-04,
                        2.87022498e-04,
                        1.13602030e-03,
                        3.34137464e-03,
                        2.88928131e-03,
                        8.56601887e-03,
                        1.23624061e-02,
                        2.19781706e-02,
                        1.76864464e-02,
                        1.08064094e-02,
                        9.90604055e-04,
                        1.97586909e-04,
                    ],
                    [
                        4.81983509e-03,
                        5.37586746e-04,
                        8.44667715e-04,
                        2.23374654e-04,
                        2.65665058e-04,
                        1.35453884e-04,
                        2.03374286e-04,
                        4.21947123e-04,
                        2.75425443e-03,
                        8.54872179e-03,
                        1.08078015e-02,
                        1.22158186e-02,
                        1.20876326e-02,
                        1.39739875e-02,
                        1.15021024e-02,
                        5.50699910e-03,
                        4.57061912e-03,
                        7.51378611e-03,
                        6.93860320e-03,
                        3.95400866e-03,
                        1.93514937e-03,
                        1.16056338e-03,
                        1.23713134e-03,
                        5.42623389e-04,
                        3.42152884e-04,
                        1.62306615e-04,
                        1.65075932e-04,
                        2.28903631e-04,
                        2.85512034e-03,
                        1.45452225e-02,
                    ],
                    [
                        1.23248058e-04,
                        2.35953170e-02,
                        1.32109541e-02,
                        6.57416094e-02,
                        5.51006996e-02,
                        1.09074081e-01,
                        7.19050942e-02,
                        3.56514716e-02,
                        2.11831703e-04,
                        4.69970690e-05,
                        3.25473371e-05,
                        2.66815265e-05,
                        2.39409941e-05,
                        1.87856540e-05,
                        2.01520618e-05,
                        4.20124420e-05,
                        5.01688423e-05,
                        2.68673152e-05,
                        2.76077991e-05,
                        5.50984813e-05,
                        3.70566839e-04,
                        1.47539510e-02,
                        1.17494668e-02,
                        4.99548870e-02,
                        7.65543417e-02,
                        1.45935909e-01,
                        1.26767666e-01,
                        8.36770904e-02,
                        1.67374485e-04,
                        2.32482291e-05,
                    ],
                    [
                        2.00639475e-02,
                        1.75103867e-04,
                        3.38517637e-04,
                        6.94233651e-05,
                        8.38390116e-05,
                        4.15189387e-05,
                        6.35712196e-05,
                        1.35098711e-04,
                        7.17513908e-03,
                        3.20129569e-02,
                        4.84784963e-02,
                        6.16664752e-02,
                        7.40117945e-02,
                        9.99031731e-02,
                        1.01308915e-01,
                        5.20727857e-02,
                        4.69337373e-02,
                        8.77618274e-02,
                        8.74492418e-02,
                        4.53753857e-02,
                        6.89821127e-03,
                        2.05931483e-04,
                        2.66270026e-04,
                        6.31471331e-05,
                        4.16208822e-05,
                        2.22582343e-05,
                        2.70806934e-05,
                        4.51343054e-05,
                        9.06189272e-03,
                        7.06927547e-02,
                    ],
                ]
            )
        }[self.string]
